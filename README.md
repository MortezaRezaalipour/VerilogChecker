# Equivalence Checker

This utility, `checker.py`, is designed to check the equivalence of circuits based on the provided error threshold.
If the Worst-Absolute Error (WAE) between the two circuits is larger than the set ET, it will trigger the "ET breached! ERROR!!!" message.
Otherwise, it will print "PASS"

## Prerequisits

- Install the following tools:

1. **Linux**
2. **Yosys**: link (https://github.com/YosysHQ/yosys)
3. **Icarus Verilog**: link (https://github.com/steveicarus/iverilog)

**Note: add the binaries of 2 and 3 to your PATH**


## Folder Structure
- `./input/`: contains the input circuits to the tool. 
- `./input/exact/`: contains the exact circuits of our benchmark suite
- `./input/test/`: several approximate circuits generated by MECALS as a simple test
- `./report/`: in case of a breach to ET, a `.txt` file is dumped into this directory that includes the input combinations for which a breach of ET happend.
- `./temp`: all the intermediary files such as `yosys`, `iverilog`, and others are stored here.

## Usage

To run the checker, use the following syntax:


### Arguments

- `--input`, `-i`: Specify the path to the circuits to be checked. This option can be used multiple times to input multiple circuits.
- `--input_port_orders`, `-ipo`: Define the order of the input ports. This can be one of the predefined order types. The default is ['1', '1'].
- `--output_port_orders`, `-opo`: Define the order of the output ports similar to the input port orders. The default is ['1', '1'].
- `'--error_threshold'`, `-et`: Set the error threshold, which is an integer value. The default is `-1`.

### Port Orders

Assuming that an n-bit binary number X is represented as X = x<sub>n-1</sub>...x<sub>0</sub>,
Port orders define how the circuit ports are arranged in the checking process:


- **Input Order Types:**
  - `1`: [n:0]a, [n:0]b => circuit(a<sub>0</sub>, a<sub>1</sub>, ..., a<sub>n</sub>, b<sub>0</sub>, b<sub>1</sub>, ..., b<sub>n</sub>, [outputs])
  - `2`: [n:0]a, [n:0]b => circuit(a<sub>n</sub>, a<sub>n-1</sub>, ..., a<sub>0</sub>, b<sub>n</sub>, b<sub>n-1</sub>, ..., b<sub>0</sub>, [outputs])

- **Output Order Types:**
  - `1`: [n:0]y, [n:0]z => circuit([inputs], y<sub>0</sub>, y<sub>1</sub>, ..., y<sub>n</sub>, z<sub>0</sub>, z<sub>1</sub>, ..., z<sub>n</sub>)
  - `2`: [n:0]y, [n:0]z => circuit([inputs], y<sub>n</sub>, y<sub>n-1</sub>, ..., y<sub>0</sub>, z<sub>n</sub>, z<sub>n-1</sub>, ..., z<sub>0</sub>)

The order types are specified using numbers, where '1' and '2' define the specific arrangement of circuit pins.

- **Note: all exact files follow the order number 1 for both inputs and outputs** 


## Example

Here's an example command to run the verifier with specific input and output port orders:

- In this example, the approximate circuit is located in `./input/test/` directory and its name is `adder_i4_o3_wce1` (that supposed to have a WAE of 1).
The exact circuit is located in `./input/exact/` directory and its name is `adder_i4_o3.v`.
- The `-i` argument is used twice to specify two circuit files: `adder_i4_o3_wce1.v` and `adder_i4_o3.v`.
- The `-ipo` and `-opo` arguments set the input and output port orders respectively. Here, an `-ipo 21` (or `-opo 21`) means that the input order (output order) type of the first circuit is `2` and the second file is `1`.  
- The error threshold set is `1`. 



```$ python3 checker.py -i  input/test/adder_i4_o3_wce1.v -i input/exact/adder_i4_o3.v -ipo 21 -opo 21 -et=1```

Upon running this command, you should get the following output:

```
args = An object of class Arguments:
self.circuits = ['input/mecals/adder_i4_o3_wce1.v', 'input/exact/adder_i4_o3.v']
self.input_port_orders = ['2', '1']
self.output_port_orders = ['2', '1']
self.et = 1

Exhaustive Simulation
ET breached!
ERROR!!!
```

This means that at least, given this specific order, this circuit does not fulfill the error threshold it claims to have.
